<?xml version="1.0" encoding="ISO-8859-1" ?>
<project name="Jaml" default="antlr">
         <property file="build.properties" />

          <path id="ANTLR.classpath">
             <pathelement location="${libdir}/antlr-3.2.jar" />
          </path>

          <target name="antlr"
                  depends="antlr-all"
                  description="Generate Java parser files from the ANTLR grammars">
             <!-- Move generated Java code to the correct package directory. -->
             <move todir="${srcdir}/${parse.package}">
                <fileset dir="${antlrdir}" includes="*.java" />
             </move>
          </target>



       <target name="antlr-all"
                     depends="prepare-antlr"
                     unless="grammarProcessed"
                     description="Generate Java lexer file from the ANTLR
lexer grammar">
                <!-- does not work, unfortunately
                <antlr:antlr3 xmlns:antlr="antlib:org/apache/tools/ant/antlr"
                              target="${srcdir}/ANTLR/${grammar.name}.g"
                              outputdirectory="${srcdir}/${parse.package}"
                              libdirectory="/home/hendrik/Java/antlr-3.1.1/lib"
                              multithreaded="true" />
                -->
                <java classname="org.antlr.Tool"
                      classpathref="ANTLR.classpath"
                      fork="true">
                   <!-- The -lib option tells ANTLR where to look for the .token file
                        generated by processing the lexer/parser grammar. -->
                   <arg line="${tool.options} ${antlrdir}/${grammar.name}.g" />
                </java>
                <!-- Move generated Java code to the correct package directory. -->
                <move todir="${srcdir}/${parse.package}">
                   <fileset dir="" includes="*.java" />
                   <fileset dir="" includes="*.tokens" />
                </move>
             </target>

          <target name="prepare-antlr">
             <uptodate property="grammarProcessed"
                       srcfile="${antlrdir}/${grammar.name}.g">
                <mapper type="merge"
                        to="${srcdir}/${parse.package}/${grammar.name}.java" />
             </uptodate>
          </target>
</project>